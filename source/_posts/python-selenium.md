---
title: Python Seleniumæ¨¡æ‹Ÿç™»å½•å¹¶è‡ªåŠ¨ä¸Šä¼ å›¾ç‰‡
date: 2019-07-14 09:25:39
categories: ç¼–ç¨‹
tags: [Python,Selenium,Base64]
---

![](python-selenium/bram-naus-n8Qb1ZAkK88-unsplash.jpg)

(Photo by [Bram Naus](https://unsplash.com/@bramnaus?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/search/photos/computer?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText))

å› é¡¹ç›®å·¥ä½œçš„éœ€è¦ï¼Œä½¿ç”¨Seleniumå†™äº†ä¸€ä¸ªæ¨¡æ‹Ÿç™»å½•ç¨‹åºï¼Œå®ç°ç™»å½•åè‡ªåŠ¨æäº¤æµ‹è¯•æ•°æ®ï¼Œå°†æµ‹è¯•åŒäº‹çš„åŒæ‰‹è§£æ”¾äº†å‡ºæ¥ã€‚



å› ä¸ºä¸Šä¼ å›¾ç‰‡éœ€è¦ä¸æ“ä½œç³»ç»Ÿäº¤äº’ï¼ŒMacOSä¸Šæ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªäº¤äº’åŠ¨ä½œçš„è§£å†³æ–¹æ¡ˆï¼Œç›®å‰åªåœ¨Windowså®ç°äº†è‡ªåŠ¨æäº¤å‘å¸ƒæ•°æ®çš„åŠŸèƒ½ï¼Œä¸‹é¢æ˜¯å¯¹è¿™ä¸ªç¨‹åºçš„ç®€å•ä»‹ç»ã€‚



é¦–å…ˆè¦æå®šç™»å½•ï¼Œç™»å½•é¡µé¢é•¿è¿™æ ·ã€‚

![](python-selenium/cp_login_page.jpg)

ï¼ˆå›¾1-ç™»å½•é¡µé¢ï¼‰

åœ¨æ¨¡æ‹Ÿç™»å½•è¿‡ç¨‹ä¸­é‡åˆ°å¥½å‡ ä¸ªé—®é¢˜ï¼ŒBase64è½¬ç æ¢è¡Œç¬¦é—®é¢˜æ›´æ˜¯è€½æäº†å°†è¿‘ä¸€å‘¨æ—¶é—´ï¼Œä¸‹é¢ä¸€ä¸€è¿›è¡Œè¯´æ˜ã€‚

<!--more-->

> 1ã€çª—å£å¥æŸ„çš„å¤„ç†
>
> å·¦ä¸‹è§’è¿™ä¸ª"åœ¨çº¿å’¨è¯¢"æ§ä»¶ï¼ŒWebDriveræ‰“å¼€é¡µé¢æ—¶ä¼šå¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ã€‚å¯¹è¯æ¡†æˆ‘å°±ä¸å»æˆªå›¾äº†ï¼Œå¾ˆå¤šç½‘ç«™éƒ½ä¼šæœ‰ã€‚è¿™ä¸ªå¯¹è¯æ¡†åœ¨ç™»å½•é¡µé¢çš„ä¸Šä¸€å±‚ï¼Œå®ƒå æ®äº†WebDriverå½“å‰çª—å£æ§ä»¶çš„å¥æŸ„ï¼Œè¦å…ˆæŠŠå®ƒå¹²æ‰ï¼Œå¦åˆ™æ‹¿ä¸åˆ°ç™»å½•é¡µé¢ä¸Šçš„HTMLå…ƒç´ ã€‚
>
> 
>
> 2ã€éªŒè¯ç "VKI4"å›¾ç‰‡éªŒè¯ç çš„è·å–
>
> å†™åˆ°è¿™é‡Œæˆ‘çªç„¶æ„è¯†åˆ°ï¼Œæˆ‘åœ¨ç¨‹åºé‡Œåšäº†æ— ç”¨åŠŸï¼Œå†™äº†å¤šä½™çš„ç¨‹åºï¼ˆåè¯äº†å†™æŠ€æœ¯åšå®¢çš„å¥½å¤„ğŸ˜„ï¼‰ã€‚ç¨‹åºä»£ç ä¸­ï¼Œæˆ‘çš„å¤„ç†æ˜¯ï¼šå…ˆå°†è¿™ä¸ªBase64ç¼–ç çš„éªŒè¯ç å­—ç¬¦ä¸²è§£ç ä¸ºå›¾ç‰‡äºŒè¿›åˆ¶æµï¼Œç„¶åç”Ÿæˆå›¾ç‰‡ï¼Œå†ç¼–ç ä¸ºBase64è°ƒç”¨ç™¾åº¦çš„æ–‡å­—è¯†åˆ«OCRæ¥å£ï¼Œå»æå–æ–‡æœ¬ã€‚çœ‹è§æ²¡æœ‰ï¼Œç»•äº†ä¸€å¤§åœˆï¼Œç›´æ¥è·å–å…ƒç´ çš„Base64ç¼–ç è°ƒç™¾åº¦çš„OCRæ¥å£å³å¯ã€‚
>
> æˆ‘ä¹‹å‰çš„å¤„ç†é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼ŒBase64ç¼–ç çš„å­—ç¬¦ä¸²è§£ç åï¼Œç”±äºå¯¹æ¢è¡Œç¬¦æ²¡æœ‰å¤„ç†ï¼Œå¯¼è‡´åˆšå¼€å§‹ç”Ÿæˆçš„å›¾ç‰‡ï¼Œæ‰“å¼€æ—¶æ€»æ˜¯æŠ¥é”™"Image Broken"ã€‚è€½æçš„ä¸€å‘¨æ—¶é—´é‡Œï¼Œæˆ‘é‡‡å–çš„Plan Bæ˜¯ç”¨å…ƒç´ åæ ‡å…ˆå®šä½éªŒè¯ç ä½ç½®ï¼Œå°†æ•´ä¸ªé¡µé¢å…¨å±æˆªå›¾ï¼Œç„¶åä»å¤§å›¾ä¸­æ‰£å°å›¾è¿™ç§æ–¹å¼ã€‚Plan Bæ˜¯å¯è¡Œçš„ï¼Œä½†è§‰å¾—å¾ˆéº»çƒ¦ï¼Œåæ¥é—®é¢˜è§£å†³åå°†è¿™ä¸ªæ–¹æ³•æ”¾å¼ƒäº†ã€‚
>
> 
>
> 3ã€ç”ŸæˆéªŒè¯ç å›¾ç‰‡
>
> å°†Base64ç¼–ç å­—ç¬¦ä¸²è§£ç ä¸ºäºŒè¿›åˆ¶æµä¹‹åï¼Œæœ€å¼€å§‹ç”Ÿæˆå›¾ç‰‡æ˜¯ä¿å­˜åˆ°æœ¬åœ°ç¡¬ç›˜ï¼Œè°ƒç™¾åº¦OCRæ—¶å†è¯»è¿›å†…å­˜ã€‚åæ¥è§‰å¾—è¿™æ ·ä¸€å‡ºä¸€è¿›ï¼Œå¤šäº†ä¸¤æ¬¡IOæ“ä½œï¼Œæ”¹ä¸ºä½¿ç”¨StringIOæ¨¡å—ï¼ˆPython3é‡Œé¢æ˜¯BytesIOæ¨¡å—ï¼‰ï¼Œå°†äºŒè¿›åˆ¶æµç›´æ¥å†™å…¥å†…å­˜ï¼Œä¸è¿›è¡ŒIOå¤„ç†ï¼Œæˆ‘æ²¡æœ‰æ¯”è¾ƒè¿‡æ‰§è¡Œæ—¶é—´ï¼Œç†è®ºä¸Šè¿™æ ·å¤„ç†ä¼šå¿«å¾ˆå¤šã€‚
>
> 
>
> 4ã€æ–‡å­—è¯†åˆ«
>
> åˆšå¼€å§‹ä½¿ç”¨Tesseract OCRè¿›è¡Œæ–‡å­—è¯†åˆ«ï¼Œè€ƒè™‘åˆ°å®ƒçš„å¯ç§»æ¤æ€§æ¯”è¾ƒå·®ï¼Œå‡†ç¡®æ€§æ²¡æœ‰å•†ä¸šäº§å“é«˜ï¼Œåé¢å°±æ”¾å¼ƒäº†ã€‚



æ¨¡æ‹Ÿç™»å½•æˆåŠŸåï¼Œæ¥ä¸‹æ¥è¦è€ƒè™‘é¡µé¢é€»è¾‘æ§åˆ¶ã€‚å“ªäº›å…ƒç´ å…ˆå‡ºæ¥ï¼Œå“ªäº›å…ƒç´ åœ¨å“ªäº›é¡µé¢æ‰å‡ºæ¥ã€‚è¿™äº›ç†Ÿç»ƒæŒæ¡Seleniumçš„WebDriverWaitå’ŒExpected Conditionæ–¹æ³•åå³åˆ»è½»æ¾è§£å†³ã€‚



"æˆ‘è¦å‘å¸ƒ"é¡µé¢ä¸Šè¿™äº›æµ‹è¯•æ•°æ®ï¼Œç®€å•çš„FakeråŒ…éƒ½å¯ä»¥æå®šï¼Œå¤æ‚ä¸€ç‚¹çš„æ¯”å¦‚èº«ä»½è¯å’Œç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç ï¼Œæœ€åä¸€ä½æ¶‰åŠåˆ°æœ‰æ•ˆæ€§æ ¡éªŒï¼Œäºæ˜¯ä¸“é—¨å†™äº†ä¸€ä¸ªCPDataç±»ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥æ‹¿å»å‚è€ƒã€‚

![](python-selenium/cp_publish_page.jpg)



ï¼ˆå›¾2-æµ‹è¯•æ•°æ®å‘å¸ƒé¡µé¢ï¼‰

åœ¨ä¸Šå›¾è¿™ä¸ªé¡µé¢ï¼Œå›¾ç‰‡ä¸Šä¼ ç¨å¾®ç‰¹æ®Šä¸€äº›ï¼Œå®ƒä¸æ˜¯ç®€å•çš„Inputæ ‡ç­¾ï¼Œä¸èƒ½å¤Ÿç›´æ¥ä½¿ç”¨WebDriverçš„sendKeysæ–¹æ³•ã€‚



å…ˆè¦ç‚¹å‡»å›¾ç‰‡ï¼Œè§¦å‘æ“ä½œç³»ç»Ÿæ‰“å¼€å›¾ç‰‡ä¸Šä¼ çª—å£ã€‚éœ€è¦ä½¿ç”¨AutoItè¾…åŠ©å®Œæˆå›¾ç‰‡ä¸Šä¼ ï¼Œäºæ˜¯å‚ç…§ç½‘ä¸Šæ•™ç¨‹åˆ†åˆ«ç”Ÿæˆäº†ä¸€ä¸ª32ä½å’Œ64ä½çš„exeç¨‹åºï¼Œç”±äºAutoItåªåœ¨Windowså¹³å°æ‰æœ‰ï¼Œè¿™ä¸ªç¨‹åºåªèƒ½åœ¨Windowsç¯å¢ƒä¸‹è¿è¡Œã€‚



ç¬¬ä¸€æ¬¡ä½¿ç”¨Seleniumå†™æ¨¡æ‹Ÿç¨‹åºï¼Œè¿‡ç¨‹æ˜¯è‰°è¾›çš„ï¼Œç»“æœæ˜¯ç¾å¥½çš„ã€‚è¿™ä¸ªç¨‹åºåœ¨Python2.7å’ŒPython3.5ç¯å¢ƒä¸‹åˆ†åˆ«æµ‹è¯•è¿‡ï¼Œéƒ½èƒ½æ‰§è¡Œï¼Œä»¥åå†ä¹Ÿä¸ç”¨è‡ªå·±æ‰‹å·¥è¾“å…¥ä¸€å¤§å †æµ‹è¯•æ•°æ®äº†ã€‚



ä½¿ç”¨[Bandicam](https://www.bandicam.cn)åšäº†ä¸€ä¸ªè‡ªåŠ¨ç™»å½•æäº¤æµ‹è¯•æ•°æ®çš„å½•å±ï¼Œ11Må¤šä¸€ç‚¹ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å»[ç™¾åº¦ç½‘ç›˜](https://pan.baidu.com/s/1LgKgYp7R5U9pn14Pg_JYig)ä¸‹è½½æŸ¥çœ‹ï¼Œæå–å¯†ç :euhoã€‚å…¨æ–‡ä»£ç è§[GitHub](https://github.com/benbendemo/learning-python/tree/master/python-selenium)ã€‚



æœ€åè¡¥å……ä¸€æ®µSeleniumçš„å‘å±•å†å²ï¼ŒSeleniumå•è¯æœ¬æ„æ˜¯ç¡’å…ƒç´ ï¼Œä½œè€…ä¸ºäº†å¯¹æŠ—QTP mercuryï¼ˆæ±å…ƒç´ ï¼‰ï¼Œæ‰å–åå«Seleniumï¼Œæˆ‘è§‰å¾—æŒºæœ‰æ„æ€ã€‚



> Jason Hugginsåœ¨2004å¹´å‘èµ·äº†Seleniumé¡¹ç›®ï¼Œå½“æ—¶èº«å¤„ThoughtWorksçš„ä»–ï¼Œä¸ºäº†ä¸æƒ³è®©è‡ªå·±çš„æ—¶é—´æµªè´¹åœ¨æ— èŠçš„é‡å¤æ€§å·¥ä½œä¸­ï¼Œå¹¸è¿çš„æ˜¯ï¼Œæ‰€æœ‰è¢«æµ‹è¯•çš„æµè§ˆå™¨éƒ½æ”¯æŒJavascriptã€‚Jasonå’Œä»–æ‰€åœ¨çš„å›¢é˜Ÿé‡‡ç”¨Javascriptç¼–å†™ä¸€ç§æµ‹è¯•å·¥å…·æ¥éªŒè¯æµè§ˆå™¨é¡µé¢çš„è¡Œä¸ºï¼›è¿™ä¸ªJavaScriptç±»åº“å°±æ˜¯Selenium coreï¼ŒåŒæ—¶ä¹Ÿæ˜¯seleniumRCã€Selenium IDEçš„æ ¸å¿ƒç»„ä»¶ã€‚Seleniumç”±æ­¤è¯ç”Ÿã€‚
>
> å…³äºSeleniumçš„å‘½åæ¯”è¾ƒæœ‰æ„æ€ï¼Œå½“æ—¶QTP mercuryæ˜¯ä¸»æµçš„å•†ä¸šè‡ªåŒ–å·¥å…·ï¼Œæ˜¯åŒ–å­¦å…ƒç´ æ±ï¼ˆä¿—ç§°æ°´é“¶ï¼‰ï¼Œè€ŒSeleniumæ˜¯å¼€æºè‡ªåŠ¨åŒ–å·¥å…·ï¼Œæ˜¯åŒ–å­¦å…ƒç´ ç¡’ï¼Œç¡’å¯ä»¥å¯¹æŠ—æ±ã€‚



**å‚è€ƒèµ„æ–™**

- [Selenium Python](http://www.testclass.net/selenium_python/)
- [Pythonçˆ¬è™«Seleniumåº“](https://www.cnblogs.com/zhaof/category/1007686.html)